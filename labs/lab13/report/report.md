# Отчёт о выполнении лабораторной работы №13

***Российский Университет Дружбы Народов***  
***Факультет Физико-Математических и Естественных Наук***

***Дисциплина:*** *Операционные системы*

***Работу выполняла:*** *Сироджидиднов Камолиддин*

***№ ст. билета:*** *1032205327*

***Группа:*** *НКНбд-01-21*

***Москва. 2022г.***

## Цель работы

Приобрести простейшие навыки разработки, анализа, тестирования и отладки
приложений в ОС типа UNIX/Linux на примере создания на языке программирования С калькулятора с простейшими функциями.

## Задание

1. В домашнем каталоге создайте подкаталог *~/work/os/lab_prog*.

2. Создайте в нём файлы: *calculate.h*, *calculate.c*, *main.c*.
Это будет примитивнейший калькулятор, способный складывать, вычитать, умножать и делить, возводить число в степень, брать квадратный корень, вычислять *sin*, *cos*, *tan*. При запуске он будет запрашивать первое число, операцию, второе число. После этого программа выведет результат и остановится.

3. Выполните компиляцию программы посредством *gcc*:
- *gcc -c calculate.c*
- *gcc -c main.c*
- *gcc calculate.o main.o -o calcul -lm*

4. При необходимости исправьте синтаксические ошибки.

5. Создайте *Makefile*.

6. С помощью *gdb* выполните отладку программы *calcul* (перед использованием *gdb* исправьте *Makefile*):
- Запустите отладчик *GDB*, загрузив в него программу для отладки:
*gdb ./calcul*
- Для запуска программы внутри отладчика введите команду *run*:
*run*
- Для постраничного (по 9 строк) просмотра исходного код используйте команду *list*:
*list*
- Для просмотра строк с 12 по 15 основного файла используйте *list* с параметрами:
*list 12,15*
- Для просмотра определённых строк не основного файла используйте *list* с параметрами:
*list calculate.c:20,29*
- Установите точку останова в файле *calculate.c* на строке номер 21:
*list calculate.c:20,27*
*break 21*
- Выведите информацию об имеющихся в проекте точка останова:
*info breakpoints*
- Запустите программу внутри отладчика и убедитесь, что программа остановится в момент прохождения точки останова:
*run*
*5*
*\-*
*backtrace*
- Отладчик выдаст следующую информацию:
*\#0 Calculate (Numeral=5, Operation=0x7fffffffd280 "-")
at calculate.c:21
\#1 0x0000000000400b2b in main () at main.c:17*
а команда *backtrace* покажет весь стек вызываемых функций от начала
программы до текущего места.
– Посмотрите, чему равно на этом этапе значение переменной *Numeral*, введя:
*print Numeral*
На экран должно быть выведено число *5*.
– Сравните с результатом вывода на экран после использования команды:
*display Numeral*
– Уберите точки останова:
*info breakpoints
delete 1*

7. С помощью утилиты *splint* попробуйте проанализировать коды файлов
*calculate.c* и *main.c*.

## Выполнение работы

1. В домашнем каталоге создал подкаталог *~/work/os/lab_prog*. 

2. Создал в нём файлы: *calculate.h*, *calculate.c*, *main.c*. 

![создала файлы](https://github.com/Chapalok/study_2021-2022_os-intro/blob/master/labs/lab13/report/image/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20(20).png?raw=true)

![calculate.c](https://github.com/Chapalok/study_2021-2022_os-intro/blob/master/labs/lab13/report/image/3.JPG?raw=true)

![calculate.h](https://github.com/Chapalok/study_2021-2022_os-intro/blob/master/labs/lab13/report/image/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20(23).png?raw=true)

![main.c](https://github.com/Chapalok/study_2021-2022_os-intro/blob/master/labs/lab13/report/image/5.JPG?raw=true)

3. Выполнил компиляцию программы посредством *gcc*:
- *gcc -c calculate.c*
- *gcc -c main.c*
- *gcc calculate.o main.o -o calcul -lm*

![gcc](https://github.com/Chapalok/study_2021-2022_os-intro/blob/master/labs/lab13/report/image/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20(21).png?raw=true)

5. Создал *Makefile*.

![makefile](https://github.com/Adriana-Arezhina/Lab/blob/main/Lab14/pict/7.JPG)

6. С помощью *gdb* выполнил отладку программы *calcul* (перед использованием *gdb* исправьте *Makefile*):
- Запустил отладчик *GDB*, загрузив в него программу для отладки:
*gdb ./calcul*

![6.1](https://github.com/Chapalok/study_2021-2022_os-intro/blob/master/labs/lab13/report/image/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%20(22).png?raw=true)

- Для запуска программы внутри отладчика введите команду *run*:
*run*

![6.2](https://github.com/Adriana-Arezhina/Lab/blob/main/Lab14/pict/9.JPG)

- Для постраничного (по 9 строк) просмотра исходного код использовала команду *list*:
*list*
- Для просмотра строк с 12 по 15 основного файла использовала *list* с параметрами:
*list 12,15*
- Для просмотра определённых строк не основного файла использовала *list* с параметрами:
*list calculate.c:20,29*

![6.3](https://github.com/Adriana-Arezhina/Lab/blob/main/Lab14/pict/10.JPG)

- Установил точку останова в файле *calculate.c* на строке номер 21:
*list calculate.c:20,27*
*break 21*
- Вывел информацию об имеющихся в проекте точка останова:
*info breakpoints*
- Запустила программу внутри отладчика и убедилась, что программа остановится в момент прохождения точки останова:
*run*
*5*
*\-*
*backtrace*
– Посмотрел, чему равно на этом этапе значение переменной *Numeral*, введя:
*print Numeral*

![6.4](https://github.com/Adriana-Arezhina/Lab/blob/main/Lab14/pict/11.JPG)

– Сравнил с результатом вывода на экран после использования команды:
*display Numeral*
– Убрал точки останова:
*info breakpoints
delete 1*

![6.5](https://github.com/Adriana-Arezhina/Lab/blob/main/Lab14/pict/12.JPG)

7. Не смог установить утилиту *splint*. 

![splint](https://github.com/Adriana-Arezhina/Lab/blob/main/Lab14/pict/error.JPG)

## Контрольные вопросы

1. C помощью функций *info* и *man*.

2. Этапы разработки приложений в UNIX:
- создание исходного кода программы, которая представляется в виде файла
- сохранение различных вариантов исходного текста;
- анализ исходного текста; необходимо отслеживать изменения исходного кода,
а также при работе более двух программистов над проектом программы нужно,
чтобы они не делали изменений кода в одно время.
- компиляция исходного текста и построение исполняемого модуля;
- тестирование и отладка;
- проверка кода на наличие ошибок
- сохранение всех изменений, выполняемых при тестировании и отладке.

3. Использование суффикса *".с"* для имени файла с программой на языке Си
отражает удобное и полезное соглашение, принятое в ОС UNIX. Для любого
имени входного файла суффикс определяет какая компиляция требуется.
Суффиксы и префиксы указывают тип объекта. Одно из полезных свойств
компилятора Си — его способность по суффиксам определять типы файлов. По
суффиксу *.c* компилятор распознает, что файл *abcd.c* должен компилироваться,
а по суффиксу *.o*, что файл *abcd.о* является объектным модулем и для
получения исполняемой программы необходимо выполнить редактирование
связей. Простейший пример командной строки для компиляции программы
*abcd.c* и построения исполняемого модуля *abcd* имеет вид: *gcc -o abcd abcd.c*.
Некоторые проекты предпочитают показывать префиксы в начале текста
изменений для старых (*old*) и новых (*new*) файлов. Опция – *prefix* может быть
использована для установки такого префикса. Плюс к этому команда *bzr diff -p1*
выводит префиксы в форме которая подходит для команды *patch -p1*.

4. Компиляция всей программы в целом и получении исполняемого модуля.

5. Мake-файл содержит последовательность записей (строк), определяющих
зависимости между файлами. Первая строка записи представляет собой список
целевых (зависимых) файлов, разделенных пробелами, за которыми следует
двоеточие и список файлов, от которых зависят целевые.

6. Текст, следующий за точкой с запятой, и все последующие строки,
начинающиеся с литеры табуляции, являются командами OC UNIX, которые
необходимо выполнить для обновления целевого файла. Таким образом,
спецификация взаимосвязей имеет формат:
*target1 [ target2...]: [:] [dependment1...]*

*[(tab)commands]*

*[#commentary]*

*[(tab)commands]*

*[#commentary]*,
где *#* — специфицирует начало комментария, так как содержимое строки,
начиная с *#* и до конца строки, не будет обрабатываться командой *make; : —* последовательность команд ОС UNIX должна содержаться в одной строке
make-файла (файла описаний), есть возможность переноса команд (*\\*), но она
считается как одна строка; *::* — последовательность команд ОС UNIX может
содержаться в нескольких последовательных строках файла описаний.

7. Пошаговая отладка программ заключается в том, что выполняется один
оператор программы и, затем контролируются те переменные, на которые
должен был воздействовать данный оператор. Если в программе имеются уже
отлаженные подпрограммы, то подпрограмму можно рассматривать, как один
оператор программы и воспользоваться вторым способом отладки программ.
Если в программе существует достаточно большой участок программы, уже
отлаженный ранее, то его можно выполнить, не контролируя переменные, на
которые он воздействует. Использование точек останова позволяет пропускать
уже отлаженную часть программы. Точка останова устанавливается в местах,
где необходимо проверить содержимое переменных или просто
проконтролировать, передаётся ли управление данному оператору.
Практически во всех отладчиках поддерживается это свойство (а также
выполнение программы до курсора и выход из подпрограммы). Затем отладка
программы продолжается в пошаговом режиме с контролем локальных и
глобальных переменных, а также внутренних регистров микроконтроллера и
напряжений на выводах этой микросхемы.

8. Основные команды отладчика *gdb*:
- *backtrace* – выводит весь путь к текущей точке останова, то есть
названия всех функций, начиная от *main()*; иными словами, выводит
весь стек функций;
- *break* – устанавливает точку останова; параметром может быть
номер строки или название функции;
- *clear* – удаляет все точки останова на текущем уровне стека (то есть
в текущей функции);
- *continue* – продолжает выполнение программы от текущей точки
до конца;
- *delete* – удаляет точку останова или контрольное выражение;
- *display* – добавляет выражение в список выражений, значения кото-
рых отображаются каждый раз при остановке программы;
- *finish* – выполняет программу до выхода из текущей функции; отображает возвращаемое значение,если такое имеется;
- *info breakpoints* – выводит список всех имеющихся точек останова;
- *info watchpoints* – выводит список всех имеющихся контрольных
выражений;
- *list* – выводит исходный код; в качестве параметра передаются
название файла исходного кода, затем, через двоеточие, номер
начальной и конечной строки;
- *next* – пошаговое выполнение программы, но, в отличие от команды
*step*, не выполняет пошагово вызываемые функции;
- *print* – выводит значение какого-либо выражения (выражение пере-
даётся в качестве параметра);
- *run* – запускает программу на выполнение;
- *set* – устанавливает новое значение переменной
- *step* – пошаговое выполнение программы;
- *watch* – устанавливает контрольное выражение, программа остановится, как
только значение контрольного выражения изменится;

9. Схема отладки программы, которую я использовала при выполнении лабораторной работы:
1) Выполнили компиляцию программы
2) Увидели ошибки в программе
3) Открыли редактор и исправили программу
4) Загрузили программу в отладчик *gdb*
5) *run* — отладчик выполнил программу, мы ввели требуемые значения.
6) Программа завершена, *gdb* не видит ошибок.

10. У меня не было синтаксических ошибок в программе.

11. Средства, повышающие понимание исходного кода программы:
- *cscope* - исследование функций, содержащихся в программе;
- *splint* — критическая проверка программ, написанных на языке Си.

12. Основные задачи, решаемые программой *splint*:
1) Проверка корректности задания аргументов всех использованных в
программе функций, а также типов возвращаемых ими значений;
2) Поиск фрагментов исходного текста, корректных с точки зрения синтаксиса
языка Си, но малоэффективных с точки зрения их реализации или содержащих
в себе семантические ошибки;
3) Общая оценка мобильности пользовательской программы.

## Вывод

Я приобрел простейшие навыки разработки, анализа, тестирования и отладки
приложений в ОС типа UNIX/Linux на примере создания на языке программирования С калькулятора с простейшими функциями.
